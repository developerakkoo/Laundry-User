"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[513],{513:(j,y,o)=>{o.r(y),o.d(y,{SearchPageModule:()=>b});var p=o(177),h=o(9417),a=o(5374),v=o(5260),d=o(467),t=o(3953),S=o(8786),I=o(5122);function L(n,u){if(1&n&&(t.j41(0,"ion-item")(1,"ion-thumbnail",1),t.nrm(2,"img",6),t.k0s(),t.j41(3,"ion-label"),t.EFF(4),t.j41(5,"p"),t.EFF(6,"Best in Class services"),t.k0s()(),t.nrm(7,"ion-icon",7),t.k0s()),2&n){const c=u.$implicit;t.R7$(4),t.SpI("",c.name," ")}}const m=[{path:"",component:(()=>{var n;class u{constructor(e,r){this.router=e,this.logic=r,this.laundryFilter={name:""},this.allLaundries=[]}ngOnInit(){}ionViewDidEnter(){this.getAllLaundries()}onSearchChange(e){console.log(e.detail.value)}getAllLaundries(){var r,e=this;this.logic.getAllLaundries().subscribe({next:(r=(0,d.A)(function*(l){console.log("Shops Fetched!"),console.log(l),e.allLaundries=l.data.content}),function(i){return r.apply(this,arguments)}),error:function(){var r=(0,d.A)(function*(l){console.log(l)});return function(i){return r.apply(this,arguments)}}()})}onClearEvent(e){console.log(e)}}return(n=u).\u0275fac=function(e){return new(e||n)(t.rXU(v.Ix),t.rXU(S.W))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-search"]],decls:16,vars:8,consts:[[1,"ion-no-border",3,"translucent"],["slot","start"],["defaultHref","/tabs/tabs/tab1"],["mode","ios","placeholder","Search laundries","inputmode","decimal","type","decimal","showCancelButton","always",3,"ngModelChange","ionClear","ionChange","ngModel","debounce"],[3,"fullscreen"],[4,"ngFor","ngForOf"],["src","https://placehold.co/100"],["slot","end","name","arrow-forward"]],template:function(e,r){1&e&&(t.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),t.EFF(3,"My Search"),t.k0s(),t.j41(4,"ion-buttons",1),t.nrm(5,"ion-back-button",2),t.k0s()(),t.j41(6,"ion-searchbar",3),t.mxI("ngModelChange",function(i){return t.DH7(r.laundryFilter.name,i)||(r.laundryFilter.name=i),i}),t.bIt("ionClear",function(i){return r.onClearEvent(i)})("ionChange",function(i){return r.onSearchChange(i)}),t.k0s()(),t.j41(7,"ion-content",4)(8,"ion-list")(9,"ion-list-header")(10,"ion-label"),t.EFF(11,"Your recent searches"),t.k0s(),t.j41(12,"ion-button"),t.EFF(13,"Clear All"),t.k0s()(),t.DNE(14,L,8,1,"ion-item",5),t.nI1(15,"filterBy"),t.k0s()()),2&e&&(t.Y8G("translucent",!0),t.R7$(6),t.R50("ngModel",r.laundryFilter.name),t.Y8G("debounce",250),t.R7$(),t.Y8G("fullscreen",!0),t.R7$(7),t.Y8G("ngForOf",t.i5U(15,5,r.allLaundries,r.laundryFilter)))},dependencies:[p.Sq,h.BC,h.vS,a.Jm,a.QW,a.W9,a.eU,a.iq,a.uz,a.he,a.nf,a.AF,a.S1,a.Zx,a.BC,a.ai,a.Gw,a.el,I.L]}),u})()}];let U=(()=>{var n;class u{}return(n=u).\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.$C({type:n}),n.\u0275inj=t.G2t({imports:[v.iI.forChild(m),v.iI]}),u})(),b=(()=>{var n;class u{}return(n=u).\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.$C({type:n}),n.\u0275inj=t.G2t({imports:[p.MD,h.YN,I.x,a.bv,U]}),u})()},8786:(j,y,o)=>{o.d(y,{W:()=>b});var p=o(467),h=o(1626),a=o(4412),v=o(8810),d=o(8141),t=o(9437),S=o(7673),I=o(7468),L=o(6354);const s_URL="https://api.breezyemart.com/api/v1/";var m=o(3953),U=o(8490);let b=(()=>{var n;class u{constructor(e,r){this.http=e,this.storage=r,this.categories=[],this.address=[],this.laundriesByCategory=[],this.services=[],this.allLaundries=[],this.accessToken=new a.t(""),this.userId=new a.t(""),this.userProfileUpdated=new a.t(""),this.categoriesSubject=new a.t(this.categories),this.category$=this.categoriesSubject.asObservable(),this.addressSubject=new a.t(this.address),this.address$=this.addressSubject.asObservable(),this.laundriesByCategorySubject=new a.t([]),this.laundryByCategory$=this.laundriesByCategorySubject.asObservable(),this.servicesSubject=new a.t([]),this.allLaundriesSubject=new a.t([]),this.laundry$=this.allLaundriesSubject.asObservable(),this.init()}init(){var e=this;return(0,p.A)(function*(){let r=yield e.storage.get("accessToken"),l=yield e.storage.get("userId"),i=yield e.storage.get("profileUpdated");e.accessToken.next(r),e.userId.next(l),e.userProfileUpdated.next(i)})()}handleError(e){return console.error("An error occurred:",e.message),(0,v.$)("Something went wrong; please try again later.")}getUserId(){var e=this;return(0,p.A)(function*(){const r=yield e.storage.get("userId");if(r)return r;throw new Error("User Not Found in local Storgare")})()}register(e){return this.http.post(s_URL+"partner/register",e)}login(e){return this.http.post(s_URL+"user/login",e)}logout(){return this.http.get(s_URL+`user/logout?userId=${this.userId.value}`)}getUserProfile(){return this.http.get(s_URL+`user/get-current-user?userId=${this.userId.value}`)}updateUserProfile(e){return this.http.put(s_URL+`user/update-profile?userId=${this.userId.value}`,e)}getAllCategories(){this.http.get(s_URL+"partner/category/getAll").pipe((0,d.M)(e=>{console.log(e),this.categoriesSubject.next(e)}),(0,t.W)(this.handleError)).subscribe()}getAllAddress(){return this.http.get(s_URL+`user/get/all-address/${this.userId.value}`)}addUserAddress(e){return this.http.post(s_URL+`user/add-address?userId=${this.userId.value}`,e)}getUserAddress(){return this.http.get(s_URL+`user/get/all-address/${this.userId.value}`)}getLaundryByCategory(e,r,l,i){let f=(new h.Nl).set("categoryId","66a7496d1f27b4f5fb506c1d").set("userId",i).set("latitude",e).set("longitude",r);this.http.get(s_URL+"partner/shop/get-all",{params:f}).pipe((0,d.M)(g=>{console.log(g),this.laundriesByCategorySubject.next(g)}),(0,t.W)(this.handleError)).subscribe()}getServiceByLaundry(){let e=(new h.Nl).set("search","").set("latitude","18.5925785").set("longitude","73.7183639");this.http.get(s_URL+"partner/shop/get/by/category",{params:e}).pipe((0,d.M)(r=>{console.log(r),this.allLaundriesSubject.next(r)}),(0,t.W)(this.handleError)).subscribe()}getAllLaundries(){let e=(new h.Nl).set("search","").set("latitude","18.5925785").set("longitude","73.7183639");return this.http.get(s_URL+"partner/shop/get-all",{params:e})}getServiceByLaundryId(e){return this.http.get(s_URL+`partner/service/get/shopId/${e}`)}getAllOffers(){return this.http.get(s_URL+"admin/promoCode/get-all")}like(e){return this.http.post(s_URL+`partner/shop/like/${e}/${this.userId.value}`,{})}unlike(e){return this.http.post(s_URL+`partner/shop/unlike/${e}/${this.userId.value}`,{})}addToCart(e,r,l){return console.log(`Quantity added is in htttp ${r}`),this.http.post(s_URL+"cart/add",{userId:this.userId.value,quantity:r,serviceId:e,selectedQuantityType:l})}removeFromCart(e,r){return this.http.post(s_URL+"cart/remove",{userId:this.userId.value.toString(),quantity:r,serviceId:e})}fetchCartAndServices(e){const r=this.http.get(s_URL+`cart/${this.userId.value}`).pipe((0,t.W)(i=>(console.error("Cart fetch error:",i),(0,S.of)({data:{products:[]}})))),l=this.http.get(s_URL+`partner/service/get/shopId/${e}`).pipe((0,t.W)(i=>(console.error("Services fetch error:",i),(0,S.of)({data:{content:[]}}))));return(0,I.p)([r,l]).pipe((0,L.T)(([i,f])=>{const g=i.data.products||[];return(f.data.content||[]).map($=>{const F=g.find(P=>P.serviceId._id===$._id);return{...$,quantity:F?F.quantity:0}})}))}getCart(){return this.http.get(s_URL+`cart/${this.userId.value}`)}checkout(e){return this.http.post(s_URL+"order/initiate/payment",{amount:e},{headers:{"x-access-token":this.accessToken.value.toString()}})}calculateCartAmount(e){return this.http.post(s_URL+"order/calculate/amount-to-pay",{userId:this.userId.value,code:e},{headers:{"x-access-token":this.accessToken.value}})}placeOrder(e,r,l,i,f,g,R,C){return this.http.post(s_URL+"order/place",{userId:this.userId.value,dropoffAddressId:e,pickupAddressId:r,pickupTime:l,dropoffTime:i,selfService:f,priceDetails:g,orderType:R,products:C})}getAllUserOrders(){return this.http.get(s_URL+`order/get/order/${this.userId.value}`)}getUserSubscription(){return this.http.get(s_URL+"subscription/get/all-plans")}getSubscriptionByUserId(){return this.http.get(s_URL+`subscription/get/${this.userId.value}`)}purchaseSubscription(e,r){return this.http.post(s_URL+"subscription/purchase",{userId:this.userId.value,planId:e,paymentDetails:r})}}return(n=u).\u0275fac=function(e){return new(e||n)(m.KVO(h.Qq),m.KVO(U.u))},n.\u0275prov=m.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}),u})()}}]);