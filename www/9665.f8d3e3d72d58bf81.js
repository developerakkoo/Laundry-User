"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9665],{8786:(x,C,n)=>{n.d(C,{W:()=>S});var b=n(467),m=n(1626),o=n(4412),U=n(8810),f=n(8141),I=n(9437),e=n(7673),P=n(7468),k=n(6354);const s_URL="https://api.breezyemart.com/api/v1/";var R=n(3953),j=n(8490);let S=(()=>{var v;class w{constructor(t,u){this.http=t,this.storage=u,this.categories=[],this.address=[],this.laundriesByCategory=[],this.services=[],this.allLaundries=[],this.accessToken=new o.t(""),this.userId=new o.t(""),this.userProfileUpdated=new o.t(""),this.categoriesSubject=new o.t(this.categories),this.category$=this.categoriesSubject.asObservable(),this.addressSubject=new o.t(this.address),this.address$=this.addressSubject.asObservable(),this.laundriesByCategorySubject=new o.t([]),this.laundryByCategory$=this.laundriesByCategorySubject.asObservable(),this.servicesSubject=new o.t([]),this.allLaundriesSubject=new o.t([]),this.laundry$=this.allLaundriesSubject.asObservable(),this.init()}init(){var t=this;return(0,b.A)(function*(){let u=yield t.storage.get("accessToken"),p=yield t.storage.get("userId"),g=yield t.storage.get("profileUpdated");t.accessToken.next(u),t.userId.next(p),t.userProfileUpdated.next(g)})()}handleError(t){return console.error("An error occurred:",t.message),(0,U.$)("Something went wrong; please try again later.")}getUserId(){var t=this;return(0,b.A)(function*(){const u=yield t.storage.get("userId");if(u)return u;throw new Error("User Not Found in local Storgare")})()}register(t){return this.http.post(s_URL+"partner/register",t)}login(t){return this.http.post(s_URL+"user/login",t)}logout(){return this.http.get(s_URL+`user/logout?userId=${this.userId.value}`)}getUserProfile(){return this.http.get(s_URL+`user/get-current-user?userId=${this.userId.value}`)}updateUserProfile(t){return this.http.put(s_URL+`user/update-profile?userId=${this.userId.value}`,t)}getAllCategories(){this.http.get(s_URL+"partner/category/getAll").pipe((0,f.M)(t=>{console.log(t),this.categoriesSubject.next(t)}),(0,I.W)(this.handleError)).subscribe()}getAllAddress(){return this.http.get(s_URL+`user/get/all-address/${this.userId.value}`)}addUserAddress(t){return this.http.post(s_URL+`user/add-address?userId=${this.userId.value}`,t)}getUserAddress(){return this.http.get(s_URL+`user/get/all-address/${this.userId.value}`)}getLaundryByCategory(t,u,p,g){let F=(new m.Nl).set("categoryId","66a7496d1f27b4f5fb506c1d").set("userId",g).set("latitude",t).set("longitude",u);this.http.get(s_URL+"partner/shop/get-all",{params:F}).pipe((0,f.M)(L=>{console.log(L),this.laundriesByCategorySubject.next(L)}),(0,I.W)(this.handleError)).subscribe()}getServiceByLaundry(){let t=(new m.Nl).set("search","").set("latitude","18.5925785").set("longitude","73.7183639");this.http.get(s_URL+"partner/shop/get/by/category",{params:t}).pipe((0,f.M)(u=>{console.log(u),this.allLaundriesSubject.next(u)}),(0,I.W)(this.handleError)).subscribe()}getAllLaundries(){let t=(new m.Nl).set("search","").set("latitude","18.5925785").set("longitude","73.7183639");return this.http.get(s_URL+"partner/shop/get-all",{params:t})}getServiceByLaundryId(t){return this.http.get(s_URL+`partner/service/get/shopId/${t}`)}getAllOffers(){return this.http.get(s_URL+"admin/promoCode/get-all")}like(t){return this.http.post(s_URL+`partner/shop/like/${t}/${this.userId.value}`,{})}unlike(t){return this.http.post(s_URL+`partner/shop/unlike/${t}/${this.userId.value}`,{})}addToCart(t,u,p){return console.log(`Quantity added is in htttp ${u}`),this.http.post(s_URL+"cart/add",{userId:this.userId.value,quantity:u,serviceId:t,selectedQuantityType:p})}removeFromCart(t,u){return this.http.post(s_URL+"cart/remove",{userId:this.userId.value.toString(),quantity:u,serviceId:t})}fetchCartAndServices(t){const u=this.http.get(s_URL+`cart/${this.userId.value}`).pipe((0,I.W)(g=>(console.error("Cart fetch error:",g),(0,e.of)({data:{products:[]}})))),p=this.http.get(s_URL+`partner/service/get/shopId/${t}`).pipe((0,I.W)(g=>(console.error("Services fetch error:",g),(0,e.of)({data:{content:[]}}))));return(0,P.p)([u,p]).pipe((0,k.T)(([g,F])=>{const L=g.data.products||[];return(F.data.content||[]).map(l=>{const a=L.find(i=>i.serviceId._id===l._id);return{...l,quantity:a?a.quantity:0}})}))}getCart(){return this.http.get(s_URL+`cart/${this.userId.value}`)}checkout(t){return this.http.post(s_URL+"order/initiate/payment",{amount:t},{headers:{"x-access-token":this.accessToken.value.toString()}})}calculateCartAmount(t){return this.http.post(s_URL+"order/calculate/amount-to-pay",{userId:this.userId.value,code:t},{headers:{"x-access-token":this.accessToken.value}})}placeOrder(t,u,p,g,F,L,r,c){return this.http.post(s_URL+"order/place",{userId:this.userId.value,dropoffAddressId:t,pickupAddressId:u,pickupTime:p,dropoffTime:g,selfService:F,priceDetails:L,orderType:r,products:c})}getAllUserOrders(){return this.http.get(s_URL+`order/get/order/${this.userId.value}`)}getUserSubscription(){return this.http.get(s_URL+"subscription/get/all-plans")}getSubscriptionByUserId(){return this.http.get(s_URL+`subscription/get/${this.userId.value}`)}purchaseSubscription(t,u){return this.http.post(s_URL+"subscription/purchase",{userId:this.userId.value,planId:t,paymentDetails:u})}}return(v=w).\u0275fac=function(t){return new(t||v)(R.KVO(m.Qq),R.KVO(j.u))},v.\u0275prov=R.jDH({token:v,factory:v.\u0275fac,providedIn:"root"}),w})()},9665:(x,C,n)=>{n.r(C),n.d(C,{ViewLaundryPageModule:()=>L});var b=n(177),m=n(9417),o=n(5374),U=n(5260),f=n(467),I=n(617),e=n(3953),P=n(3455),k=n(8786),s=n(1518),R=n(5122);const j=(r,c)=>({"filter-badge-solid":r,"filter-badge-outline":c}),S=()=>[0,.25,.5,.45];function v(r,c){1&r&&(e.j41(0,"div",15),e.nrm(1,"img",16),e.k0s())}function w(r,c){if(1&r&&e.nrm(0,"app-laundry-card",19),2&r){const l=c.$implicit,a=e.XpG(2);e.Y8G("id",l._id)("likes",null==l?null:l.likes)("categories",null==l?null:l.category)("name",null==l?null:l.name)("category",null==l||null==l.category[0]?null:l.category[0].name)("currentUserId",a.userId)("address",null==l||null==l.address?null:l.address.city)}}function V(r,c){if(1&r&&(e.j41(0,"ion-list")(1,"ion-list-header")(2,"ion-label",17),e.EFF(3,"Top Laundries "),e.k0s()(),e.DNE(4,w,1,7,"app-laundry-card",18),e.nI1(5,"filterBy"),e.k0s()),2&r){const l=e.XpG();e.R7$(4),e.Y8G("ngForOf",e.i5U(5,1,l.allLaundries,l.laundryFilter))}}function t(r,c){1&r&&(e.j41(0,"ion-content")(1,"ion-list")(2,"ion-list-header")(3,"ion-label",20),e.EFF(4,"Sort By"),e.k0s()(),e.nrm(5,"hr"),e.j41(6,"ion-radio-group",21)(7,"ion-item",22)(8,"ion-label",23),e.EFF(9,"Rating: High To Low"),e.k0s(),e.nrm(10,"ion-radio",24),e.k0s(),e.j41(11,"ion-item",22)(12,"ion-label",23),e.EFF(13,"Delivery time:High To Low"),e.k0s(),e.nrm(14,"ion-radio",24),e.k0s(),e.j41(15,"ion-item",22)(16,"ion-label",23),e.EFF(17,"Cost: High To Low"),e.k0s(),e.nrm(18,"ion-radio",24),e.k0s(),e.j41(19,"ion-item",22)(20,"ion-label",23),e.EFF(21,"Cost: Low To high"),e.k0s(),e.nrm(22,"ion-radio",24),e.k0s()()()())}const p=[{path:"",component:(()=>{var r;class c{constructor(a,i,d,h,y){this.router=a,this.haptics=i,this.route=d,this.logic=h,this.actionSheetController=y,this.swiperModules=[I.Jl],this.allLaundries=[],this.isLoading=!1,this.isFilterOpen=!1,this.selectedFilter="",this.laundryFilter={name:""},this.title=this.route.snapshot.paramMap.get("name"),this.categoryId=this.route.snapshot.paramMap.get("id")}ngOnInit(){}getUserId(){var a=this;return(0,f.A)(function*(){a.userId=yield a.logic.getUserId(),console.log(`UserId in tab1 page ${a.userId}`)})()}ionViewDidEnter(){this.getUserId(),this.getAllLaundries()}handleRefresh(a){setTimeout(()=>{this.getAllLaundries(),a.target.complete()},500)}getAllLaundries(){var i,a=this;this.logic.getAllLaundries().subscribe({next:(i=(0,f.A)(function*(d){console.log("Shops Fetched!"),console.log(d),a.allLaundries=d.data.content}),function(h){return i.apply(this,arguments)}),error:function(){var i=(0,f.A)(function*(d){console.log(d)});return function(h){return i.apply(this,arguments)}}()})}getLaundriesById(){var i,a=this;this.logic.laundryByCategory$.subscribe({next:(i=(0,f.A)(function*(d){console.log("Fetching all laundries"),console.log(d),a.allLaundries=d.data}),function(h){return i.apply(this,arguments)}),error:function(){var i=(0,f.A)(function*(d){console.log(d)});return function(h){return i.apply(this,arguments)}}()})}applyFilter(a){this.haptics.hapticsImpactLight(),this.selectedFilter=a,this.getAllLaundries()}openFilterModal(){this.isFilterOpen=!this.isFilterOpen}onSearchChange(a){}openPage(a){this.router.navigate([a])}}return(r=c).\u0275fac=function(a){return new(a||r)(e.rXU(U.Ix),e.rXU(P.o),e.rXU(U.nX),e.rXU(k.W),e.rXU(o.GD))},r.\u0275cmp=e.VBU({type:r,selectors:[["app-view-laundry"]],decls:27,vars:27,consts:[["modal",""],[1,"ion-no-border",3,"translucent"],["slot","start"],["defaultHref","/tabs/tab1"],["placeholder","Filter laundries","inputmode","decimal","type","decimal","mode","ios","showCancelButton","always",3,"ngModelChange","ionChange","ngModel","debounce"],[1,"filter-container"],[1,"filter-badge",3,"click"],[1,"filter-badge-outline",3,"click","ngClass"],[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],["pullingIcon","arrow-down","pullingText","Pull to refresh","refreshingSpinner","circles","refreshingText","Refreshing..."],["class","loading-container",4,"ngIf"],[1,"container"],[4,"ngIf"],[1,"filter-modal",3,"isOpen","initialBreakpoint","breakpoints"],[1,"loading-container"],["src","assets/icon/laundry.gif",1,"loading-img"],[2,"font-size","16px","font-weight","500"],["imageUrl","assets/laundry-demo.svg","ratings","4.5",3,"id","likes","categories","name","category","currentUserId","address",4,"ngFor","ngForOf"],["imageUrl","assets/laundry-demo.svg","ratings","4.5",3,"id","likes","categories","name","category","currentUserId","address"],[1,"nunito-bold"],["value","strawberries","mode","md"],["lines","none"],[1,"nutino-regular"],["slot","end"]],template:function(a,i){if(1&a){const d=e.RV6();e.j41(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3),e.k0s(),e.j41(4,"ion-buttons",2),e.nrm(5,"ion-back-button",3),e.k0s()(),e.j41(6,"ion-searchbar",4),e.mxI("ngModelChange",function(y){return e.eBV(d),e.DH7(i.laundryFilter.name,y)||(i.laundryFilter.name=y),e.Njj(y)}),e.bIt("ionChange",function(y){return e.eBV(d),e.Njj(i.onSearchChange(y))}),e.k0s(),e.j41(7,"div",5)(8,"div",6),e.bIt("click",function(){return e.eBV(d),e.Njj(i.openFilterModal())}),e.EFF(9,"Filters"),e.k0s(),e.j41(10,"div",7),e.bIt("click",function(){return e.eBV(d),e.Njj(i.applyFilter("nearme"))}),e.EFF(11," Near me "),e.k0s(),e.j41(12,"div",7),e.bIt("click",function(){return e.eBV(d),e.Njj(i.applyFilter("fastdelivery"))}),e.EFF(13," Fast Delivery "),e.k0s(),e.j41(14,"div",7),e.bIt("click",function(){return e.eBV(d),e.Njj(i.applyFilter("radius"))}),e.EFF(15," 5 Km's Radius "),e.k0s(),e.j41(16,"div",7),e.bIt("click",function(){return e.eBV(d),e.Njj(i.applyFilter("rating"))}),e.EFF(17," Highest Rated "),e.k0s()()(),e.j41(18,"ion-content",8)(19,"ion-refresher",9),e.bIt("ionRefresh",function(y){return e.eBV(d),e.Njj(i.handleRefresh(y))}),e.nrm(20,"ion-refresher-content",10),e.k0s(),e.DNE(21,v,2,0,"div",11),e.j41(22,"div",12),e.DNE(23,V,6,4,"ion-list",13),e.k0s(),e.j41(24,"ion-modal",14,0),e.DNE(26,t,23,0,"ng-template"),e.k0s()()}2&a&&(e.Y8G("translucent",!1),e.R7$(3),e.JRh(i.title),e.R7$(3),e.R50("ngModel",i.laundryFilter.name),e.Y8G("debounce",250),e.R7$(4),e.Y8G("ngClass",e.l_i(14,j,"nearme"===i.selectedFilter,"nearme"!==i.selectedFilter)),e.R7$(2),e.Y8G("ngClass",e.l_i(17,j,"fastdelivery"===i.selectedFilter,"fastdelivery"!==i.selectedFilter)),e.R7$(2),e.Y8G("ngClass",e.l_i(20,j,"radius"===i.selectedFilter,"radius"!==i.selectedFilter)),e.R7$(2),e.Y8G("ngClass",e.l_i(23,j,"rating"===i.selectedFilter,"rating"!==i.selectedFilter)),e.R7$(2),e.Y8G("fullscreen",!1),e.R7$(3),e.Y8G("ngIf",i.isLoading),e.R7$(2),e.Y8G("ngIf",!i.isLoading),e.R7$(),e.Y8G("isOpen",i.isFilterOpen)("initialBreakpoint",.45)("breakpoints",e.lJ4(26,S)))},dependencies:[b.YU,b.Sq,b.bT,m.BC,m.vS,o.QW,o.W9,o.eU,o.uz,o.he,o.nf,o.AF,o.KO,o.f0,o.To,o.Ki,o.S1,o.BC,o.ai,o.Sb,o.Je,o.Gw,o.el,s.H,R.L],styles:[".container[_ngcontent-%COMP%]{margin-top:10px;display:flex;flex-direction:column;justify-content:center;align-items:center}ion-badge[_ngcontent-%COMP%]{padding:10px}.filter-container[_ngcontent-%COMP%]{display:flex;overflow-x:auto;white-space:nowrap;padding:4px;background-color:#f0f0f04d;align-items:center}.filter-badge[_ngcontent-%COMP%]{display:flex;padding:10px 20px;margin:3px;background-color:#8f35c7;color:#fff;border-radius:20px;cursor:pointer;white-space:nowrap;flex-shrink:0;transition:background-color .3s ease;justify-content:center;align-items:center;height:30px;width:auto;font-size:12px}.filter-badge-outline[_ngcontent-%COMP%]{display:flex;padding:6px;margin:3px;border:1px solid #8F35C7;color:#8f35c7;border-radius:20px;cursor:pointer;white-space:nowrap;transition:background-color .3s ease;justify-content:center;align-items:center;height:30px;width:auto;font-size:12px}.filter-badge-solid[_ngcontent-%COMP%]{display:flex;padding:6px;margin:3px;border:1px solid #8F35C7;background-color:#8f35c7;color:#f9f9f9;border-radius:20px;cursor:pointer;white-space:nowrap;transition:background-color .3s ease;justify-content:center;align-items:center;height:30px;width:auto;font-size:12px}.filter-badge[_ngcontent-%COMP%]:hover{background-color:#8f35c7}.filter-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:8px}.filter-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f0f0f0}.filter-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#8f35c7;border-radius:10px;border:2px solid #f0f0f0}"]}),c})()},{path:"add/:id",loadChildren:()=>Promise.all([n.e(2076),n.e(6286)]).then(n.bind(n,6286)).then(r=>r.AddPageModule)},{path:"add-order-modal",loadChildren:()=>Promise.all([n.e(2076),n.e(7757)]).then(n.bind(n,7757)).then(r=>r.AddOrderModalPageModule)}];let g=(()=>{var r;class c{}return(r=c).\u0275fac=function(a){return new(a||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[U.iI.forChild(p),U.iI]}),c})();var F=n(541);let L=(()=>{var r;class c{}return(r=c).\u0275fac=function(a){return new(a||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[b.MD,m.YN,R.x,o.bv,F.G,g]}),c})()}}]);